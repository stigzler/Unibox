<UserControl x:Class="Unibox.Views.SettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:Unibox.Views"
             xmlns:properties="clr-namespace:Unibox.Properties"
             xmlns:vm="clr-namespace:Unibox.ViewModels"
             xmlns:controls="clr-namespace:Unibox.Controls"
             d:DataContext="{d:DesignInstance Type=vm:SettingsVM, IsDesignTimeCreatable=True}"
             mc:Ignorable="d" Cursor="{Binding Cursor}"
             xmlns:converters="clr-namespace:Unibox.Converters"
             d:Background="#606060" d:Foreground="#f0f0f0"
             d:DesignHeight="700" d:DesignWidth="800"
             FontSize="{Binding Source={x:Static properties:Settings.Default},Path=AppFontSize}">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/Dictionaries/Styles.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <Style TargetType="Image">
                <Setter Property="RenderOptions.BitmapScalingMode" Value="HighQuality" />
            </Style>
            <converters:RegionToFullNameConverter x:Key="RegionToFullNameConverter" />
            <converters:RegionToShortNameConverter x:Key="RegionToShortNameConverter" />
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid Margin="10">

        <TabControl>

            <TabItem Header="Screenscraper">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <GroupBox Grid.Row="0" Header="Connection">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Column="0" Grid.Row="0" Text="Username:" VerticalAlignment="Center" />
                            <TextBlock Grid.Column="0" Grid.Row="1" Text="Password:" VerticalAlignment="Center" />

                            <TextBox Grid.Column="1" Grid.Row="0" Text="{Binding SsUsername}" Margin="5" Grid.ColumnSpan="2" />

                            <controls:BindablePasswordBox Grid.Column="1" Grid.Row="1" Password="{Binding SsPassword}" Margin="5" Grid.ColumnSpan="2" />

                            <Expander Grid.Column="0" Grid.Row="2" Header="API Keys (optional)" Grid.ColumnSpan="3" Margin="6">
                                <Grid Margin="0,10,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="auto" />
                                        <RowDefinition Height="auto" />
                                        <RowDefinition Height="auto" />
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Column="0" Grid.Row="0" Text="Dev Username:" VerticalAlignment="Center" />
                                    <TextBlock Grid.Column="0" Grid.Row="1" Text="Dev Password:" VerticalAlignment="Center" />
                                    <TextBlock Grid.Column="0" Grid.Row="2" Text="API Software Name:" VerticalAlignment="Center" />

                                    <TextBox Grid.Column="1" Grid.Row="0" Margin="5" Text="{Binding SsApiUsername}" />
                                    <controls:BindablePasswordBox Grid.Column="1" Grid.Row="1"  Margin="5" Password="{Binding SsApiPassword}" />
                                    <TextBox Grid.Column="1" Grid.Row="2" Margin="5" Text="{Binding SsApiName}" />
                                </Grid>
                            </Expander>

                            <TextBlock Grid.Column="0" Grid.Row="3" Text="Threads:" VerticalAlignment="Center" />
                            <TextBlock Grid.Column="1" Grid.Row="3" VerticalAlignment="Center" Margin="5" Text="{Binding Source={x:Static properties:Settings.Default},Path=ssThreads}" />

                            <StackPanel Grid.Column="2" Grid.Row="3" Orientation="Horizontal">
                                <Button  HorizontalAlignment="Right"  Content="Test Connection" Margin="5"
                                         Padding="{Binding Source={x:Static properties:Settings.Default},Path=AppButtonPadding}"
                                         Command="{Binding TestScreenscraperConnectionCommand}"
                                         ToolTip="Test Connection and set thread count" Click="Button_Click" />
                                <Button  HorizontalAlignment="Right"   Content="Save" Margin="5" Padding="{Binding Source={x:Static properties:Settings.Default},Path=AppButtonPadding}"
                                         Command="{Binding SaveScreenscraperCredentialsCommand}"
                                         ToolTip="Save credentials" />
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <GroupBox Grid.Row="1"  Header="Setup" Margin="0,10,0,0">
                        <StackPanel>
                            <CheckBox Content="Use Screenscraper when adding Roms" Margin="5"
                                      IsChecked="{Binding Source={x:Static properties:Settings.Default},Path=UseSsForRomAdds}" />
                            <CheckBox Content="Do not add Rom if no Screenscraper match found" Margin="5"
                                      IsChecked="{Binding Source
                                ={x:Static properties:Settings.Default},Path=StopRomAddOnNoScreenscraperMatch}" />
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Grid.Row="2"  Header="Priorities" Margin="0,10,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="auto" />
                            </Grid.ColumnDefinitions>
                            <ListView Grid.Column="0"  SelectedItem="{Binding SelectedRegion}"
                                      ItemsSource="{Binding Source={x:Static properties:Settings.Default},Path=SsRegionPriorities, Mode=TwoWay}">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Regions" Width="200" DisplayMemberBinding="{Binding Converter={StaticResource RegionToFullNameConverter}}" />
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            <StackPanel Grid.Column="1" Orientation="Vertical">
                                <Button Margin="2" Command="{Binding MoveSelectedRegionToTopCommand}" Padding="{Binding Source={x:Static properties:Settings.Default},Path=AppButtonPadding}">
                                    <Image Source="/Resources/Images/arrowTop.png" />
                                </Button>
                                <Button Margin="2" Command="{Binding MoveSelectedRegionUpCommand}" Padding="{Binding Source={x:Static properties:Settings.Default},Path=AppButtonPadding}">
                                    <Image Source="/Resources/Images/arrowUp.png" />
                                </Button>
                                <Button Margin="2" Command="{Binding MoveSelectedRegionDownCommand}" Padding="{Binding Source={x:Static properties:Settings.Default},Path=AppButtonPadding}">
                                    <Image Source="/Resources/Images/arrowDown.png" />
                                </Button>
                            </StackPanel>
                        </Grid>
                    </GroupBox>
                </Grid>
            </TabItem>

            <TabItem Header="Application Settings">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>

                    <GroupBox Grid.Row="0" Header="UI" VerticalAlignment="Top">
                        <!--<StackPanel Orientation="Vertical">
                            <Grid>
                            </Grid>
                        </StackPanel>-->

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                                <RowDefinition Height="auto" />
                            </Grid.RowDefinitions>

                            <TextBlock  Grid.Column="0" Grid.Row="0" Text="Font Size" VerticalAlignment="Center" Margin="5"
                                           ToolTip="Adjust the size of Unibox's font" />
                            <TextBox x:Name="FontSizeTB" Grid.Column="1" Grid.Row="0" Margin="5" PreviewTextInput="FontSizeTB_PreviewTextInput"
                                        LostFocus="FontSizeTB_LostFocus"
                                        Text="{Binding Source={x:Static properties:Settings.Default},Path=AppFontSize}" />

                            <TextBlock  Grid.Column="0" Grid.Row="1" Text="Command Button Padding" VerticalAlignment="Center" Margin="5"
                                           ToolTip="Controls the space around the command buttons" />
                            <TextBox x:Name="ButtonPaddingTB" Grid.Column="1" Grid.Row="1" Margin="5" PreviewTextInput="ButtonPaddingTB_PreviewTextInput"
                                        Text="{Binding Source={x:Static properties:Settings.Default},Path=AppButtonPadding}"
                                     LostFocus="ButtonPaddingTB_LostFocus" />

                            <TextBlock  Grid.Column="0" Grid.Row="2" Text="List Item Padding" VerticalAlignment="Center" Margin="5"
                                           ToolTip="Controls the space around any dropdown list items" />
                            <TextBox x:Name="ListPaddingTB" Grid.Column="1" Grid.Row="2" Margin="5" PreviewTextInput="ListPaddingTB_PreviewTextInput"
                                        Text="{Binding Source={x:Static properties:Settings.Default},Path=AppListPadding}"
                                     LostFocus="ListPaddingTB_LostFocus" />

                            <CheckBox Grid.Column="1" Grid.Row="3" Content="Dark Theme" Margin="5"
                                      IsChecked="{Binding Source={x:Static properties:Settings.Default},Path=AppDarkMode}"
                                      Command="{Binding ToggleDarkModeCommand}" />
                        </Grid>
                    </GroupBox>

                    <GroupBox Grid.Row="1" Header="Plugin Integration"  VerticalAlignment="Top" Margin="0,10,0,0">
                        <StackPanel Orientation="Vertical">

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                    <RowDefinition Height="auto" />
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Column="0" Grid.Row="0" Text="Port" VerticalAlignment="Center" Margin="5"
                                           ToolTip="Change this if you have another application using this port to a number between 49152-65535. Also needs changing in the Unibox plugin on all installations." />
                                <TextBox x:Name="PortNumberTB" Grid.Column="1" Grid.Row="0" Margin="5" PreviewTextInput="PortNumberTB_PreviewTextInput"
                                        Text="{Binding Source={x:Static properties:Settings.Default},Path=MessagingPort}" />
                                <CheckBox Grid.Column="1" Grid.Row="1" Content="Allow Offline Game Addition" Margin="5"
                                      IsChecked="{Binding Source={x:Static properties:Settings.Default},Path=AllowOfflineGameUpdate}"
                                      ToolTip="Updates the launchbox database xml files directly if Launchbox or Bigbox aren't running (i.e. can't use the plugin)." />
                                <CheckBox Grid.Column="1" Grid.Row="2" Content="Backup Platform XML" Margin="5"
                                      IsChecked="{Binding Source={x:Static properties:Settings.Default},Path=BackupPlatformXml}"
                                      ToolTip="If Allow Offline Game Addition is selected, the platform's xml file will be backed up prior to any changes. Unibox only keeps one backup, so if you're concerned, ensure you check the platform xml file after every game addition." />
                            </Grid>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <TabItem Header="About">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                        <RowDefinition Height="auto" />
                    </Grid.RowDefinitions>

                    <Image Grid.Row="0" Source="/Resources/Images/UniboxLogo.png" Width="128" Margin="0,50,0,0" />
                    <TextBlock Grid.Row="1" FontFamily="Arial Narrow" Text="Unibox" FontSize="24" FontWeight="Bold"  HorizontalAlignment="Center" />
                    <TextBlock Grid.Row="2" HorizontalAlignment="Center" Text="by stigzler" FontFamily="Agency FB" FontSize="20" FontWeight="Bold"
                               Margin="0,10,0,4" />
                    <Image Grid.Row="3" Source="/Resources/Images/WillyRound.png" Height="24" />
                    <TextBlock Grid.Row="4" Text="{Binding AssemblyVersion}" HorizontalAlignment="Center" />
                    <!--<GroupBox Grid.Row="4" Header="Debug">
                        <Button Content="Test" Command="{Binding TestCommand}" />
                    </GroupBox>-->
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>